# Migration `20200510152117-init`

This migration has been generated by pradel at 5/10/2020, 3:21:17 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "AppBuildStatus" AS ENUM ('PENDING', 'IN_PROGRESS', 'COMPLETED', 'ERRORED');

CREATE TYPE "DbTypes" AS ENUM ('REDIS', 'POSTGRESQL', 'MONGODB', 'MYSQL');

CREATE TABLE "public"."User" (
"avatarUrl" text  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"email" text  NOT NULL ,"githubAccessToken" text  NOT NULL ,"githubId" text  NOT NULL ,"id" text  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"username" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."App" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"githubId" text  NOT NULL ,"githubRepoUrl" text  NOT NULL ,"id" text  NOT NULL ,"name" text  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"userId" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."AppBuild" (
"appId" text  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" text  NOT NULL ,"status" "AppBuildStatus" NOT NULL ,"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"userId" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Database" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" text  NOT NULL ,"name" text  NOT NULL ,"type" "DbTypes" NOT NULL ,"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"userId" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "User.username" ON "public"."User"("username")

CREATE UNIQUE INDEX "User.githubId" ON "public"."User"("githubId")

ALTER TABLE "public"."App" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."AppBuild" ADD FOREIGN KEY ("appId")REFERENCES "public"."App"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."AppBuild" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Database" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200510152117-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,69 @@
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id                      String     @default(uuid()) @id
+  createdAt               DateTime   @default(now())
+  updatedAt               DateTime   @default(now())
+  username                String     @unique
+  avatarUrl               String
+  email                   String
+  githubId                String     @unique
+  githubAccessToken       String
+  App                     App[]
+  Database                Database[]
+  AppBuild                AppBuild[]
+}
+
+model App {
+  id            String     @default(uuid()) @id
+  createdAt     DateTime   @default(now())
+  updatedAt     DateTime   @default(now())
+  name          String
+  githubRepoUrl String
+  githubId      String
+  user          User       @relation(fields: [userId], references: [id])
+  userId        String
+  appBuild      AppBuild[]
+}
+
+model AppBuild {
+  id        String         @default(uuid()) @id
+  createdAt DateTime       @default(now())
+  updatedAt DateTime       @default(now())
+  status    AppBuildStatus
+  app       App            @relation(fields: [appId], references: [id])
+  appId     String
+  user      User           @relation(fields: [userId], references: [id])
+  userId    String
+}
+
+enum AppBuildStatus {
+  PENDING
+  IN_PROGRESS
+  COMPLETED
+  ERRORED
+}
+
+model Database {
+  id        String   @default(uuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now())
+  name      String
+  type      DbTypes
+  user      User     @relation(fields: [userId], references: [id])
+  userId    String
+}
+
+enum DbTypes {
+  REDIS
+  POSTGRESQL
+  MONGODB
+  MYSQL
+}
```
